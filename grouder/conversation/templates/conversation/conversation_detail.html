{% extends 'core/core_base.html' %}

{% block title %}Conversation{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
  <h1 class="mb-4 text-2xl md:text-3xl">Conversation</h1>

  <!-- Thread -->
  <div class="space-y-3">
    {% for message in conversation.messages.all %}
      <div class="flex {% if message.created_by == request.user %}justify-end{% else %}justify-start{% endif %}">
        <div class="max-w-[85%] md:max-w-[70%] rounded-2xl px-4 py-3
                    {% if message.created_by == request.user %} bg-blue-100 {% else %} bg-gray-100 {% endif %}">
          <p class="text-sm text-gray-600 mb-1 break-words">
            <strong>{{ message.created_by.username }}</strong>
            <span class="ml-2 opacity-70">@ {{ message.created_at }}</span>
          </p>
          <p class="break-words whitespace-pre-wrap">{{ message.content }}</p>
        </div>
      </div>
    {% endfor %}
  </div>

  <!-- Composer -->
  <form method="post" action="." class="mt-6 bg-white p-4 rounded-xl shadow-sm">
    {% csrf_token %}
    <div class="space-y-3">
      {{ form.as_p }}
      <button class="w-full md:w-auto py-3 px-6 text-base md:text-lg bg-teal-500 hover:bg-teal-700 rounded-xl text-white">
        Send
      </button>
    </div>
  </form>
</div>
{% endblock %}
